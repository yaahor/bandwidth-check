<div class="app-video app__card">
  <ng-container *ngIf="quality | async as quality; else spinner">
    <video
      appCamera
      (videoRecorded)="onVideoRecorded($event)"
      #camera="appCamera"
      autoplay
      playsinline
      [muted]="true"
    ></video>

    <div class="controls">
      <div class="quality-indicator">
        Current Quality: {{ quality }}
      </div>

      <button
        (click)="camera.toggleRecording()"
        [class.recording]="camera.isRecording"
        class="record-btn"
      >
        {{ camera.isRecording ? 'Stop Recording' : 'Start Recording' }}
      </button>
    </div>
  </ng-container>

  <ng-template #spinner>
    <div class="app-video__spinner">
      <app-spinner></app-spinner>
    </div>
  </ng-template>
</div>

<div class="recordings app__card">
  <ng-container *ngIf="records$ | async as records">
    <h3 *ngIf="records.length > 0">Recorded Videos</h3>
    <div class="recordings-list">
      <div *ngFor="let record of records; trackBy: trackRecord" class="recording-item">
        <video controls>
<!--          <source [src]="record.url" type="video/webm">-->
        </video>
        <div class="recording-info">
          <span>{{ record.timestamp | date:'medium' }}</span>
        </div>
      </div>
    </div>
  </ng-container>
</div>
